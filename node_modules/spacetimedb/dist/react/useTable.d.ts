import type { RowType, UntypedTableDef } from '../lib/table';
import type { Prettify } from '../lib/type_util';
export interface UseTableCallbacks<RowType> {
    onInsert?: (row: RowType) => void;
    onDelete?: (row: RowType) => void;
    onUpdate?: (oldRow: RowType, newRow: RowType) => void;
}
export type Value = string | number | boolean;
export type Expr<Column extends string> = {
    type: 'eq';
    key: Column;
    value: Value;
} | {
    type: 'and';
    children: Expr<Column>[];
} | {
    type: 'or';
    children: Expr<Column>[];
};
export declare const eq: <Column extends string>(key: Column, value: Value) => Expr<Column>;
export declare const and: <Column extends string>(...children: Expr<Column>[]) => Expr<Column>;
export declare const or: <Column extends string>(...children: Expr<Column>[]) => Expr<Column>;
export declare const isEq: <Column extends string>(e: Expr<Column>) => e is Extract<Expr<Column>, {
    type: "eq";
}>;
export declare const isAnd: <Column extends string>(e: Expr<Column>) => e is Extract<Expr<Column>, {
    type: "and";
}>;
export declare const isOr: <Column extends string>(e: Expr<Column>) => e is Extract<Expr<Column>, {
    type: "or";
}>;
export declare function evaluate<Column extends string>(expr: Expr<Column>, row: Record<Column, any>): boolean;
export declare function toString<TableDef extends UntypedTableDef>(tableDef: TableDef, expr: Expr<ColumnsFromRow<RowType<TableDef>>>): string;
/**
 * This is just the identity function to make things look like SQL.
 * @param expr
 * @returns
 */
export declare function where<Column extends string>(expr: Expr<Column>): Expr<Column>;
/**
 * Extracts the column names from a RowType whose values are of type Value.
 * Note that this will exclude columns that are of type object, array, etc.
 */
type ColumnsFromRow<R> = {
    [K in keyof R]-?: R[K] extends Value | undefined ? K : never;
}[keyof R] & string;
/**
 * React hook to subscribe to a table in SpacetimeDB and receive live updates as rows are inserted, updated, or deleted.
 *
 * This hook returns a snapshot of the table's rows, filtered by an optional `where` clause, and provides a loading state
 * until the initial subscription is applied. It also allows you to specify callbacks for row insertions, deletions, and updates.
 *
 * The hook must be used within a component tree wrapped by `SpacetimeDBProvider`.
 *
 * Overloads:
 * - `useTable(tableName, where, callbacks?)`: Subscribe to a table with a filter and optional callbacks.
 * - `useTable(tableName, callbacks?)`: Subscribe to a table without a filter, with optional callbacks.
 *
 * @template DbConnection The type of the SpacetimeDB connection.
 * @template RowType The type of the table row.
 * @template TableName The name of the table.
 *
 * @param tableName - The name of the table to subscribe to.
 * @param whereClauseOrCallbacks - (Optional) Either a filter expression (where clause) or the callbacks object.
 * @param callbacks - (Optional) Callbacks for row insert, delete, and update events.
 *
 * @returns A snapshot object containing the current rows and the subscription state (`'loading'` or `'ready'`).
 *
 * @throws Error if the hook is used outside of a `SpacetimeDBProvider`.
 *
 * @example
 * ```tsx
 * const { rows, state } = useTable('users', where(eq('isActive', true)), {
 *   onInsert: (row) => console.log('Inserted:', row),
 *   onDelete: (row) => console.log('Deleted:', row),
 *   onUpdate: (oldRow, newRow) => console.log('Updated:', oldRow, newRow),
 * });
 * ```
 */
export declare function useTable<TableDef extends UntypedTableDef>(tableDef: TableDef, where: Expr<ColumnsFromRow<RowType<TableDef>>>, callbacks?: UseTableCallbacks<Prettify<RowType<TableDef>>>): [readonly Prettify<RowType<TableDef>>[], boolean];
/**
 * React hook to subscribe to a table in SpacetimeDB and receive live updates as rows are inserted, updated, or deleted.
 *
 * This hook returns a snapshot of the table's rows, filtered by an optional `where` clause, and provides a loading state
 * until the initial subscription is applied. It also allows you to specify callbacks for row insertions, deletions, and updates.
 *
 * The hook must be used within a component tree wrapped by `SpacetimeDBProvider`.
 *
 * Overloads:
 * - `useTable(tableName, where, callbacks?)`: Subscribe to a table with a filter and optional callbacks.
 * - `useTable(tableName, callbacks?)`: Subscribe to a table without a filter, with optional callbacks.
 *
 * @template DbConnection The type of the SpacetimeDB connection.
 * @template RowType The type of the table row.
 * @template TableName The name of the table.
 *
 * @param tableName - The name of the table to subscribe to.
 * @param whereClauseOrCallbacks - (Optional) Either a filter expression (where clause) or the callbacks object.
 * @param callbacks - (Optional) Callbacks for row insert, delete, and update events.
 *
 * @returns A snapshot object containing the current rows and the subscription state (`'loading'` or `'ready'`).
 *
 * @throws Error if the hook is used outside of a `SpacetimeDBProvider`.
 *
 * @example
 * ```tsx
 * const { rows, state } = useTable('users', where(eq('isActive', true)), {
 *   onInsert: (row) => console.log('Inserted:', row),
 *   onDelete: (row) => console.log('Deleted:', row),
 *   onUpdate: (oldRow, newRow) => console.log('Updated:', oldRow, newRow),
 * });
 * ```
 */
export declare function useTable<TableDef extends UntypedTableDef>(tableDef: TableDef, callbacks?: UseTableCallbacks<Prettify<RowType<TableDef>>>): [readonly Prettify<RowType<TableDef>>[], boolean];
export {};
//# sourceMappingURL=useTable.d.ts.map