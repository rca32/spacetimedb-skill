---
run: run-013
work_item: define-sync-and-anti-cheat-contracts
intent: mmo-core-server-foundation
generated: 2026-02-07T15:10:47Z
mode: validate
---

# Implementation Walkthrough: 동기화/안티치트 계약 정의

## Summary
`DESIGN/06-sync-anti-cheat.md`를 서버 권위 기반 계약 문서로 재구성했다. 서버/클라이언트 책임 경계, reducer 검증 매핑, 고핑/레이트 리미팅, 위반 점수 기반 제재 상태 전이를 표준 형태로 고정했다.

## Structure Overview
입력 경로는 reducer 진입 검증과 영향 시점 재검증의 2단계로 정의하고, 상태 전송 경로는 10-20Hz 스냅샷과 중요 이벤트 즉시 푸시로 분리했다. 운영/보안 경로는 이상 탐지 누적과 단계적 제재 전이로 분리해 오탐과 누락 위험을 줄이는 구조로 정리했다.

## Files Changed

### Created

| File | Purpose |
|------|---------|
| (none) | |

### Modified

| File | Changes |
|------|---------|
| `DESIGN/06-sync-anti-cheat.md` | 서버 권위/검증/동기화/제재를 reducer 계약 중심으로 재정리 |

## Key Implementation Details

### 1. 권위 경계 명확화
이동/행동/전투/거래별로 서버 최종 판정과 클라이언트 예측 허용 범위를 분리했다.

### 2. reducer 검증 2단계 고정
진입 시 1차 검증, 타격/체결/완료 시점 2차 검증 규칙을 공통 패턴으로 명시했다.

### 3. 제재 상태 전이 구체화
점수 누적 기반 단계(정상/경고/자동 제한/수동 검토/영구 제재)를 표로 정의했다.

## Decisions Made

| Decision | Choice | Rationale |
|----------|--------|-----------|
| 동기화 모델 | 10-20Hz 스냅샷 + 중요 이벤트 즉시 푸시 | 지연 체감과 대역폭 균형 |
| 검증 시점 | reducer entry + impact 2단계 | 지연 악용 및 조기완료 exploit 방지 |
| 제재 방식 | 점수 누적 기반 단계 전이 | 오탐 최소화와 운영 개입 지점 확보 |

## Deviations from Plan
None

## Dependencies Added

| Package | Why Needed |
|---------|------------|
| (none) | |

## How to Verify

1. **계약 항목 존재 확인**
```bash
rg -n "서버 권위|클라이언트|예측|10-20Hz|스냅샷|델타|레이트|고핑|위반|제재|상태 전이|move_|attack_start|attack_scheduled|attack_impact|trade_" DESIGN/06-sync-anti-cheat.md
```
Expected: 핵심 계약 항목이 모두 검색된다.

2. **외부 참고 문구 제거 확인**
```bash
rg -n "BitCraft|참고" DESIGN/06-sync-anti-cheat.md
```
Expected: 결과 없음.

## Test Coverage
- Tests added: 0
- Coverage: N/A (문서 작업)
- Status: passing

## Developer Notes
후속 구현 단계에서 reducer 실명(`move_player`, `trade_open` 등)으로 계약 표를 구체화하면 추적 매트릭스 품질이 올라간다.

---
*Generated by specs.md - fabriqa.ai FIRE Flow Run run-013*
