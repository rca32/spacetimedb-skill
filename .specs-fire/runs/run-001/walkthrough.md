---
run: run-001
work_item: scaffold-domain-folder-structure-and-module-entrypoints
intent: stitch-full-game-server-development
generated: 2026-02-07T16:16:20Z
mode: validate
---

# Implementation Walkthrough: 도메인 폴더 구조 및 모듈 엔트리포인트 스캐폴딩

## Summary

`DESIGN/DETAIL/stitch-server-folder-structure.md` 기준으로 `game_server/src`에 도메인 디렉터리 골격과 엔트리포인트 파일을 추가했다.
기존 기능은 유지한 채 `lib.rs`에서 모듈 경계를 선언하고 lifecycle reducer를 `init.rs`/`module.rs`로 분리했다.

## Structure Overview

최상위 `lib.rs`는 공개 모듈 경계와 핵심 테이블/리듀서 정의를 유지하고,
초기화/접속 훅은 각각 `init.rs`, `module.rs`로 분리해 엔트리 책임을 명확히 했다.
기타 도메인 폴더는 후속 기능 구현을 위한 컴파일 가능한 빈 모듈 골격으로 배치했다.

## Files Changed

### Created

| File | Purpose |
|------|---------|
| `stitch-server/crates/game_server/src/module.rs` | `client_connected` 라이프사이클 엔트리 정의 |
| `stitch-server/crates/game_server/src/init.rs` | `init` 라이프사이클 엔트리 정의 |
| `stitch-server/crates/game_server/src/config/mod.rs` | 설정 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/auth/mod.rs` | 인증 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/agents/mod.rs` | 에이전트 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/tables/mod.rs` | 테이블 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/reducers/mod.rs` | 리듀서 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/services/mod.rs` | 서비스 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/subscriptions/mod.rs` | 구독 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/validation/mod.rs` | 검증 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/errors/mod.rs` | 에러 도메인 모듈 골격 |
| `stitch-server/crates/game_server/src/utils/mod.rs` | 유틸 도메인 모듈 골격 |

### Modified

| File | Changes |
|------|---------|
| `stitch-server/crates/game_server/src/lib.rs` | 도메인 모듈 공개 선언 추가, lifecycle reducer를 별도 엔트리 파일로 이동 가능한 구조로 정렬 |

## Key Implementation Details

### 1. Module Entrypoint Separation

`#[spacetimedb::reducer(init)]`와 `#[spacetimedb::reducer(client_connected)]`를 각각 `init.rs`, `module.rs`로 분리해 엔트리 책임을 명확히 했다.

### 2. Compile-safe Skeleton First

도메인별 `mod.rs`는 문서화된 골격만 먼저 추가하고, 기능 로직 이동은 후속 work item에서 수행하도록 최소 변경으로 유지했다.

## Decisions Made

| Decision | Choice | Rationale |
|----------|--------|-----------|
| 스캐폴딩 범위 | `mod.rs` 중심 최소 골격 생성 | 현재 acceptance criteria가 구조/엔트리 정렬이기 때문 |
| 기존 로직 보존 | 핵심 reducer/table 로직은 `lib.rs`에 유지 | 대규모 이동 리스크를 줄이고 빌드 안정성 확보 |

## Deviations from Plan

None.

## Dependencies Added

| Package | Why Needed |
|---------|------------|
| (none) | 기존 의존성만 사용 |

## How to Verify

1. **Compile Check**
```bash
cd stitch-server
cargo check -p game_server
```
Expected: `Finished dev profile` 출력

2. **Spacetime Build**
```bash
cd stitch-server/crates/game_server
spacetime build
```
Expected: `Build finished successfully.` 출력

## Test Coverage

- Tests added: 0
- Coverage: 0%
- Status: passing

## Developer Notes

- `wasm-opt` 경고는 성능 최적화 도구 부재 알림이며, 빌드 실패는 아니다.
- 후속 work item에서 `tables/*`, `reducers/*` 실제 파일 분리를 단계적으로 진행하는 것이 안전하다.

---
*Generated by specs.md - fabriqa.ai FIRE Flow Run run-001*
